---
title: "STAT325: named entity recognition analysis of XX"
author: "XX YOUR NAME HERE XX"
date: "2024-02-22"
date-format: iso
format: pdf
editor: source
---
  
```{r}
#| label: setup
#| include: false
library(mosaic)
library(tidyverse)
library(tidytext)
library(nametagger)
library(tictoc)
```

```{r}
file_name <- "anno_moby.Rds"
stopifnot(file.exists(file_name))
anno <- readRDS(file_name)
```

```{r}
token_with_chapters <- anno$token |>
  mutate(chapter_number = cumsum(str_detect(token, 
                                            regex("^CHAPTER",
                                                  ignore_case = FALSE)) & tid == 1))

test <- token_with_chapters |>
  filter(chapter_number > 32)
  
```


```{r}
to_plot <- token_with_chapters |>
  group_by(chapter_number) |>
  summarize(total = n(),
            noun_count = sum(ifelse(upos == "ADJ", 1, 0)),
            prop_noun = noun_count/total,
            .groups = "drop") |>
  filter(total > 10, prop_noun > 0)

ggplot(to_plot, aes(x = chapter_number, y = prop_noun)) +
  geom_point() +
  geom_smooth(se = FALSE)
```

```{r}
# load your data package data
# run the named entity recognition model